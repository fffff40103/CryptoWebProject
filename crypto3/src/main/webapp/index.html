<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
	<title>Stock Socket Demo</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
	<script>
		$(function() {
			$.ajax({
		        url: 'http://localhost:8080/crypto2/mvc/crypto/send',
		        success: function ( data ){
					console.log(data);
		        }
		    });
		});
		
		var socket = new WebSocket('ws://localhost:8080/crypto2/mvc/websocket');

		socket.onopen = function(event) {
		    console.log('WebSocket連線已建立');
		    console.log(event)

		};
		
		socket.onmessage=function(event){
			let message = JSON.parse(event.data);
			if(message.type === 'initial' && message.action === '建立連線'){
				let cryptoData = message.cryptos;
        		console.log('伺服器傳來的一次性資料:', cryptoData);
			}else{
				let cryptos=message.content;
				
				let h1=document.querySelector("h1");
				h1.innerText=message.content[1].name;
			}
			
			
		
			
		
		}
		
		
		socket.onclose = function() {
		    console.log('WebSocket連線已關閉');
		};
		
	</script>
</head>
<body>
	<h1 class="h1t">Hi</h1>
	
</body>
</html>